{% extends 'hotel/base.html' %}

{% load static %}

{% block content %}

<section class="hero-section">
  <div class="container">
      <div class="row">
          <div class="col-lg-6">
          </div>
          <div class="col-xl-4 col-lg-4 offset-xl-4 offset-lg-1">
              <div class="booking-form">
                  <h3 class="">Make Payment for </h3>
                  <form id="paymentForm">
                    <div class="form-submit">
                        <button type="submit" onclick="payWithPaystack()"> Pay â‚¦{{booking.get_total_amount}}
                            <i class="bi-credit-card"></i>
                        </button>
                    </div>
                </form>
          </div>
          </div>
      </div>
  </div>
  <div class="hero-slider owl-carousel">
      <div class="hs-item set-bg" data-setbg="{% static 'img/hero/hero-1.jpg' %}"></div>
      <div class="hs-item set-bg" data-setbg="{% static 'img/hero/hero-2.jpg' %}"></div>
      <div class="hs-item set-bg" data-setbg="{% static 'img/hero/hero-3.jpg' %}"></div>
  </div>
</section>


<script src="https://js.paystack.co/v2/inline.js"></script>

<script>
    const paymentForm = document.getElementById('paymentForm');
    paymentForm.addEventListener("submit", payWithPaystack, false);
    function payWithPaystack(e) {
    e.preventDefault();

    let handler = PaystackPop.setup({
        key: '{{paystack_public_key}}', // Replace with your public key
        email: {{payment.customer.email}},
        amount: {{payment.get_amount}},
        ref: ''+Math.floor((Math.random() * 1000000000) + 1), // generates a pseudo-unique reference. Please replace with a reference you generated. Or remove the line entirely so our API will generate one for you
        // label: "Optional string that replaces customer email"
        onClose: function(){
        alert('Window closed.');
        },
        callback: function(response){
        let message = 'Payment complete! Reference: ' + response.reference;
        alert(message);
        }
    });

    handler.openIframe();
    }

</script>

{% endblock content %}
